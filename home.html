<!DOCTYPE html>
<html>
    <head>
        <title>Items finder</title>
        <style>
        body{background-color:white;color:black;font-size:13px;font-family:arial;}
#sidebar{background-color:#303030;position:fixed;width:22%;margin:0;top:0;left:0;bottom:0;padding:20px 20px 20px 30px;color:white;overflow:auto;box-sizing:border-box;}
.main{margin-left:25%;width:70%;overflow:auto;box-sizing:border-box;}
.tab-head{position:sticky;top:0;background-color:white;}
table{width:100%;}
table,td{border:1px solid gray;border-collapse:collapse;}
th,td{padding:15px;}
td:hover{color:red;}
th{background-color:white;color:black;}
#popup{border:2px solid blue;bottom:40%;width:40%;position:fixed;padding:10px;margin-left:50%;display:none;}
#iconscontainer{display:flex;align-items:center;justify-content:center;}
.icon{width:40px;height:40px;}
#heading{font-weight:bold;text-align:left;}
.line{margin-right:5px;}
#file-download{display:none;padding:10px 0;}
#additems{position:fixed;display:flex;width:70%;align-items:center;justify-content:center;text-align:center;z-index:1;}
.addremove{margin:30px;height:30px;width:30px;background-color:orange;border:none;}
.addremove:hover{background-color:#303030;color:white;}
#lastsolditem{margin-bottom:60px;}
.menu{margin-top:15px;color:white;max-width:60%;}
.active::before{background-image:url(https://1.bp.blogspot.com/-oQPCIGdj_Zk/YO_NfpxsB2I/AAAAAAAAC2E/C7Ulsq5O54wQsGmnjOsU-_rM-NfJr3JDwCLcBGAsYHQ/s240/iconmonstr-arrow-37-240.png);background-size:contain;content:"";width:8px;height:8px;display:inline-block;float:right;position:relative;transform:translateY(4px);}
.menubreak{margin:30px 10px 30px auto;border:0.5px solid #c0c0c0;}select{margin-right:30px;}
#similar{position:fixed;border:2px solid gray;top:8%;border-radius:10px;padding:20px;background-color:white;color:#303030;z-index:2;}
#closesimilar{width:20px;height:20px;border:none;background-color:#303030;color:white;float:right;border-radius:50%;margin:5px 5px;}
#case .main:not(:first-child){display:none;}
#searchsimilar{width:30%;height:30px;border-radius:5px;border:1px solid gray;padding-left:5px;}
#addsimilarlist{background-color:pink;padding:3px;margin:0 5px;}
#similar-name{width:25%;height:30px;border-radius:5px;border:1px solid gray;padding-left:5px;}
#add-similar{width:40px;height:30px;border-radius:5px;background-color:#303030;color:white;border:none;margin-left:8px;}
.similar-list{position:relative;background-color:#f0e68c;line-height:1.8;padding:20px;border-radius:5px;margin:25px auto;box-sizing:border-box;font-size:14px;}
.similar-list:first-of-type{display:none;}
#similar-models{margin-right:50px;}
#similar-models>span:not(:first-child)::before{content:"-";margin:0 20px;}
#confirm-list{position:absolute;top:50%;transform:translateY(-50%);right:20px;color:white;background-color:#303030;border:none;border-radius:5px;padding:10px;}
#list-div{max-height:300px;}
#new-order-head{display:inline-block;}
#add-order{display:inline-block;border:none;background-color:green;color:white;margin:0 7px 0 20px;width:20px;height:20px;}
#del-order{display:inline-block;width:20px;height:20px;box-sizing:border-box;border:1px solid gray;}
#new-order-item{width:25%;height:30px;border-radius:5px;border:1px solid gray;padding-left:5px;}
#add-order-to-array{width:40px;height:30px;border-radius:5px;background-color:#303030;color:white;border:none;margin-left:8px;}
#new-order-dashbord{display:none}
#new-order-list{font-size:14px;padding:5px;height:300px;}
#del-order-list{display:none;position:fixed;bottom:50px;}
#display-bord{padding:20px 0;height:300px;}
#next-items{position:fixed;color:white;border:none;padding:10px 25px;border-radius:5px;background-color:#303030;bottom:20%;}    
        </style>
    </head>
    <body>
        <div id="sidebar">
        <div id="lastsolditem">Last Sold Item</div>
        <div class="menu active">Items</div>
        <div class="menu">New Order</div>
        <div class="menu">Out Of Stock</div>
        <div class="menu">Check Stock</div>
        <div class="menu">Similar Items</div>
        <hr class="menubreak">
        <div class="menu">Backup/Restore</div>
        <div id ="addremove-menu" class="menu"><span>Add/Remove Items</span></div>
        </div>
        <section id="case">
        <div class="main static">
        <table id= "mytable1">
    <tr>
    <th>Item</th>
    <th>Size</th>
    <th>Shelf</th>
    <th>Hanger</th>
    <th>Stock</th>
    </tr>
    <tr>
    <td>Model 1</td>
    <td>0</td>
    <td class="shelf">1</td>
    <td class="hanger">5</td>
    <td class="stock">0</td>
    </tr>
     <tr>
    <td>Model 2</td>
    <td>0</td>
    <td class="shelf">1</td>
    <td class="hanger">8</td>
    <td class="stock">0</td>
    </tr>
    </table>   
         <div id="popup">
         <span id="heading">Title</span>
         <br>
         <br>
         <span class="line">Size 0</span>
         <span class="line">Shelf 0</span>
         <span class="line">Hanger 0</span>
         <span class="line">Stocks 0</span>
         <br/>
         <br/>
         <div id="iconscontainer">
         <img class="icon" src="">
         <img class="icon" src="https://blogger.googleusercontent.com/img/a/AVvXsEhzQb9lxDziCqUFDqWfMfbfofpqvYDQ51Xz8aybmtfd2HW8WNaRmS7VK4Q63WqMDdvZtGHSqtWz8NflkDXUQ-p5nLhHhRME-CvpAYHt1dJOpBpx0pkKvUtLzHAP-ysQWhhRtKg6V_m51uzIKh5HAk8gxTFfNlZxXBiceSsniIVV79rpQp-FvLDmg9DU=s240"/>
         <img class="icon" src="https://blogger.googleusercontent.com/img/a/AVvXsEjmQfqNVj6FwJ4Yox8ChrcTb36m_eZAHBE-otbcCmismlmS2PW5btcOJ8NQztNHdkZqhnU_H6xkL5U8CtKk9amrFzjIefOku5nnixQyjWmCB_H5gwVlI1yh2d97Vks5tXM10-duHgP_28OWBkfanRjbdQTr1w4TZPM-tkkY5xi-HHV9vtLYpkwtE29v=s240"/>
         <img class="icon" src="https://blogger.googleusercontent.com/img/a/AVvXsEjmQfqNVj6FwJ4Yox8ChrcTb36m_eZAHBE-otbcCmismlmS2PW5btcOJ8NQztNHdkZqhnU_H6xkL5U8CtKk9amrFzjIefOku5nnixQyjWmCB_H5gwVlI1yh2d97Vks5tXM10-duHgP_28OWBkfanRjbdQTr1w4TZPM-tkkY5xi-HHV9vtLYpkwtE29v=s240"/>
         </div>
         <div id="inputdiv">
         <textarea id="input">
         </textarea>
         <span id="gobutton">Go</span>
         </div>
         </div>
         </div>
         <div id="neworder" class="main static">
         <div class="tab-head">
         <h3 id="new-order-head">New Order</h3>
         <button id="add-order">+</button>
         <button id="del-order">-</button>
         <div id="new-order-dashbord">
         <input type="text" id="new-order-item" placeholder="Item Name"/>
         <button id="add-order-to-array">Add</button>
         </div>
         </div>
         <div id="new-order-list"></div>
         <button id="del-order-list">Delete</button>
         </div>
         <div id="outofstock" class="main static">
         <h3>Out Of Stock Items</h3>
         <p id="empty-notice-order">No Items</p>
         </div>
         <div id="checkstock" class="main static">
         <div class="tab-head">
         <h3>Check Stock</h3>
         <label for="shelf">Shelf&nbsp;</label>
         <select name="shelf" id="shelf">
         <option value="1">1&nbsp;&nbsp;</option>
         </select>
         <label for="hanger">Hanger&nbsp;</label>
         <select name="hanger" id="hanger">
         <option value="0">0&nbsp;&nbsp;</option>
         </select>
         </div>
         <div id="display-bord">
         </div>
         <button id="next-items">Next</button>
         </div>
         <div id="similar" class="main pop">
         <button id="closesimilar">×</button>
         <input type="text" id="searchsimilar" placeholder="Find Similar Items"/>
         <span id="addsimilarlist">+</span>
         <div id="createsimilarlist">
         <p>Create new list !</p>
         <input type="text" id="similar-name" placeholder="Item Name"/>
         <button id="add-similar">Add</button>
         <div id="list-div">
         <div class="similar-list">
         <div id="similar-models"></div>
         <button id="confirm-list">Create</button>
         </div>
         </div>
         </div>
         </div>
         <div id="backuporrestore" class="main">
         <h4>Backup</h4>
         <p>Backup data as a text file</p>
         <div id="file-download">
         <a download="phonecasedata.txt" href="#" id="file-link">Download</a>
         </div>
         <button id="backup-data">Backup</button>
         <br/>
         <br/>
         <h4>Restore</h4>
         <p>Choose the file in which data contains</p>
         <input type="file" id="file-importer"/>
         </br>
         </br>
         <button id="restore-data">Restore</button>
         </div>
         <div id="additems" class="main pop2">
         <button id="deleteitem" class="addremove">-</button>
         <button id="additem" class="addremove">+</button>
         <button id="confirm" class="addremove">✓</button>
         </div>
         </section>
<script>
    var alltabs  = [];
//setActive
function setActive(y=this){
var current = document.getElementsByClassName("active")[0];
alltabs.push(current);
if (alltabs.length > 3){alltabs.shift()}
current.classList.remove("active");
y.classList.add("active");
}
//opentab
function openTab(x){
var menuelms,tabs,a;
menuelms  = document.getElementsByClassName("menu");
tabs = document.getElementsByClassName("main");
function makeNone(){a =0;for (;a<tabs.length;a++){tabs[a].style.display = "none"}};
menuelms[x].addEventListener("click",function(){if(tabs[x].id!=="similar"){makeNone()};
if (tabs[x].id==="additems"){tabs[0].style.display="block"};
tabs[x].style.display="block"})
}
//New order
function addnewOrder(){
    var items,orderInput,dashBord,delButton,p;
    const currentItems = [];
    const deletedItems = [];
    orderInput = document.getElementById("new-order-item");
    dashBord = document.getElementById("new-order-dashbord");
    delButton = document.getElementById("del-order-list");
    function openDash(){
        if(dashBord.style.display==="block"){dashBord.style.display="none"}
    else{dashBord.style.display="block"};
    delButton.style.display="none";
    items = document.querySelectorAll(".order-item");
    items.forEach(function(e){e.removeEventListener("click",giveFunc);e.style.color="black"});
    if(currentItems.length>0){currentItems.splice(0,currentItems.length)}
    }
    function addOrder(){
        if(orderInput.value.length !== 0){
    p = document.createElement("P");
    p.className = "order-item";
    p.innerText = orderInput.value;
    document.getElementById("new-order-list").appendChild(p);
    orderInput.value = ""
        }
    }
    function giveFunc(){
    if(currentItems.includes(this)===false){currentItems.push(this);this.style.color="red"}
    else{currentItems.splice(currentItems.indexOf(this),1);this.style.color = "black";}}
    function addtoArr(){
    items = document.querySelectorAll(".order-item");
    items.forEach(e=>e.addEventListener("click",giveFunc));
    dashBord.style.display="none";
    delButton.style.display="block"}
    function delItems(){
        currentItems.forEach(function(itm){itm.remove();deletedItems.push(itm)});
        deletedItems.forEach(d => currentItems.splice(currentItems.indexOf(d),1))
    }
    document.getElementById("add-order").addEventListener("click",openDash);
    document.getElementById("add-order-to-array").addEventListener("click",addOrder);
    document.getElementById("del-order").addEventListener("click",addtoArr);
    delButton.addEventListener("click",delItems);
}
//out of stock
function outofStock(){
    var rows,stockCells,outofStocks,c,list,emptyNotice;
    rows = document.querySelectorAll("#mytable1 tr:not(:first-child)");
    stockCells = document.querySelectorAll("td:nth-last-child(1)");
    outofStocks = [];
    c = 0;
    for (;c<stockCells.length;c++){if(stockCells[c].innerText !== "0"){continue}outofStocks.push(rows[c])}
    list = document.createElement("OL");
    emptyNotice = document.querySelectorAll("#outofstock > p")[0];
    list.style.fontSize = "15px";
    if(outofStocks.length > 0){emptyNotice.style.display = "none";
    outofStocks.forEach(function(f){let li = document.createElement("LI");
 li.style.padding = "5px";
 li.innerText = f.firstElementChild.innerText;
 list.appendChild(li)})
    document.getElementById("outofstock").appendChild(list)}
    else{emptyNotice.style.display ="block"}
}
//Check stock
function checkStock(){
    var shelf,hanger,shelfCells,hangerCells,displayBord,hangerNums,models,shelfNums,topShelf,topHanger;
    shelf = document.getElementById("shelf");
    hanger = document.getElementById("hanger");
    shelfCells =  document.querySelectorAll("#mytable1 .shelf");
    hangerCells = document.querySelectorAll("#mytable1 .hanger");
    displayBord = document.getElementById("display-bord");
    shelfNums = [];
    hangerNums = [];
    models = document.querySelectorAll("tr:first-child");
    shelfCells.forEach(function(s){if(shelfNums.includes(s)===false){shelfNums.push(Number(s.innerText))}});
    hangerCells.forEach(function(h){if(hangerNums.includes(h)===false){hangerNums.push(Number(h.innerText))}});
    topShelf =  Math.max.apply(null,shelfNums);
    topHanger = Math.max.apply(null,hangerNums);
    if(topShelf>1){for (var k=2;k<=topShelf;k++){var op = document.createElement("OPTION");
    op.text = k;shelf.add(op)}};
    for (var j=1;j<=topHanger;j++){var op2 = document.createElement("OPTION");
    op2.text = j;hanger.add(op2)};
    function itemFilter(a){
        if(a.querySelector(".shelf").innerText === shelf.value && a.querySelector(".hanger").innerText === hanger.value){return a}
    }
    function showStock(){
        var rowsArr = Array.from(document.querySelectorAll("#mytable1 tr:not(:first-child)"));
        var checkStocks = rowsArr.filter(itemFilter);
        if (checkStocks.length > 0){displayBord.innerHTML = "";}
        else{displayBord.innerHTML = "<p>No Items / Hanger not found !</p>";};
        checkStocks.forEach(function(p){displayBord.innerHTML += "<h4>" + p.firstElementChild.innerText + "&nbsp;&nbsp;&#8209;&nbsp;&nbsp;" + p.querySelector(".stock").innerText + "</h4>" + "</br>"})
    }
    function nextStock(){
        var shelfIndex = shelf.selectedIndex;
        var hangerIndex = hanger.selectedIndex;
        if(hangerIndex === hanger.options.length-1){
        if(shelfIndex !== shelf.options.length-1){
        shelf.options[shelfIndex+1].selected = "selected";hanger.selectedIndex = "0";}}
        else{hanger.options[hangerIndex+1].selected = "selected";}
    }
    shelf.addEventListener("change",function(){showStock();hanger.selectedIndex = "0";});
    hanger.addEventListener("change",showStock);
    document.getElementById("next-items").addEventListener("click",function(){nextStock(),showStock()});
}
//Similar
function addSimilar(){
    var itemInput = document.getElementById("similar-name");
    var addButton = document.getElementById("add-similar");
    var listArr = document.getElementById("similar-models");
    var listParent = document.getElementsByClassName("similar-list")[0];
    var createButton = document.getElementById("confirm-list");
    var allArr;
    function createList(){
        listParent.style.display = "block";
        var itemSpan = document.createElement("SPAN");
        itemSpan.innerText = itemInput.value;
        listArr.appendChild(itemSpan);
    }
    function addList(){
        var spanElms = listArr.querySelectorAll("span");
        var itemsArr = [];
        var newDiv = document.createElement("DIV");
        newDiv.className = "similar-list";
        spanElms.forEach(elm => itemsArr.push(elm.innerText));
        newDiv.innerText = itemsArr.join(" - ");
        listParent.insertAdjacentElement("afterend",newDiv);
        listParent.style.display = "none";
        spanElms.forEach(el=>el.remove());
    }
    function simFilter(s){
        var searchInput = document.getElementById("searchsimilar").value.toLowerCase().replace(/ /g, "");
      if(s.indexOf(searchInput)>-1){return s}  
    }
    function loadArr(){
        allArr = [];
        var allDivs = document.querySelectorAll(".similar-list:not(:first-of-type)");
        for (v=0;v<allDivs.length;v++){var cuArr = allDivs[v].innerText.replace(/ /g, "").split(" - ").join("");allArr.push(cuArr);};
    }
    loadArr();
    function searchSim(){
        loadArr();
        var allDivs = document.querySelectorAll(".similar-list:not(:first-of-type)");
        for (var d=0;d<allDivs.length;d++){allDivs[d].style.display = "none"};
        var fArr = allArr.filter(simFilter);
        fArr.forEach(function(r){allDivs[allArr.indexOf(r)].style.display = "block";})
    }
    addButton.addEventListener("click",createList);
    createButton.addEventListener("click",addList);
    document.getElementById("addsimilarlist").addEventListener("click",searchSim)
}
//backup and restore
function exportdata(){
var link,table1,tds1,tabledata1;
link = document.getElementById("file-link");
table1 =document.getElementById("mytable1");
tds1 = table1.querySelectorAll("td");
tabledata1 = [];
for (i=0;i<tds1.length;i++){tabledata1.push(tds1[i].innerText);}
var tableDatas1 = JSON.stringify(tabledata1);
var blob = new Blob([tableDatas1],{type : 'text/plain'});
link.style.display="block";
link.href = URL.createObjectURL(blob);
document.getElementById("file-download").style.display = "block";
}
function importdata(){var imdata;
document.getElementById("file-importer").addEventListener("change",function(){
    var freader = new FileReader();
    freader.onload = function(){
    imdata = freader.result;
    document.getElementById("restore-data").onclick=function(){var imdatas = JSON.parse(imdata);
    var cells = document.getElementById("mytable1").querySelectorAll("td");
    for(j=0;j<cells.length;j++){cells[j].innerText=imdatas[j];}}
}
    freader.readAsText(this.files[0]);
    })}
//checkactive
function checkActive(){
    if(document.getElementById("addremove-menu").classList.contains("active")){
        return true
    }
}
//addorremove
function addItem(){
    var allRows,currentRow,clonedRow,row1,clonedCells;
    allRows = document.getElementsByTagName("tr");
    currentRow = allRows[allRows.length-1];
    row1 = document.getElementsByTagName("tr")[1];
    function setColor(){
    document.querySelectorAll("tr").forEach(el => el.style.backgroundColor = "white");
    currentRow.style.backgroundColor = "#ffffe0"}
function setClone(){
clonedRow = row1.cloneNode(true);
clonedRow.addEventListener("click",function(){if(checkActive()===true){currentRow = this;setColor()}});
var clonedCells = clonedRow.querySelectorAll("td");
clonedCells[0].innerText="Model";
clonedCells[1].innerText="0";
clonedCells[2].innerText="0";
clonedCells[3].innerText="0";}
setClone();
for (var d=0;d<allRows.length;d++){allRows[d].addEventListener("click",function(){if(checkActive()===true){currentRow = this;setColor()}})}
document.getElementById("additem").onclick = function(){currentRow.insertAdjacentElement("afterend",clonedRow);setClone();setColor()}
document.getElementById("deleteitem").onclick = function(){if(allRows.length > 2){currentRow.remove();currentRow = allRows[allRows.length-1];setColor()}}
}
//load
window.onload = function(){
    var tabsLength,menuelms,menuelmslength,b,i;
    tabsLength = document.getElementsByClassName("main").length;
    menuelms = document.getElementsByClassName("menu");
    menuelmslength = menuelms.length;
    b = 0;
    i = 0;
for(;b<tabsLength;b++){openTab(b)}
for (;i<menuelmslength;i++){menuelms[i].addEventListener("click",function(){setActive(this)})}
document.getElementById("closesimilar").onclick = function(){this.parentElement.style.display = "none";setActive(alltabs[alltabs.length-1])};
addItem();
document.getElementById("backup-data").addEventListener("click",exportdata);
importdata();
outofStock();
addnewOrder();
checkStock();
addSimilar()}
</script>
    </body>
</html>
